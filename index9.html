<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<style>
    *{
        margin: 0;
        padding: 0;
    }
    #wrap-log{
        width: 306px;
        height: 306px;
        background: red;
        margin: 100px auto;
    }
    .inner{
        border: 1px solid black;
        width: 100px;
        height: 100px;
        background: yellow;
        float: left;
    }
    .active{
        background: aqua;
    }
</style>
<body>
<div id="wrap-log">
    <div data-name="0" class="inner active"></div>
    <div data-name="1" class="inner"></div>
    <div data-name="2" class="inner"></div>
    <div data-name="3" class="inner"></div>
    <div data-name="4" class="inner"></div>
    <div data-name="5" class="inner"></div>
    <div data-name="6" class="inner"></div>
    <div data-name="7" class="inner"></div>
    <div data-name="8" class="inner"></div>
    <button id="btnLottery">点击抽奖</button>
</div>
<script>
    window.onload = function() {
        let btnLottery = document.querySelector("#btnLottery")
        let inner = document.querySelectorAll(".inner")
        var time,time1,time2,time4;
        let defaultConfig = {
            index: 0,
            speed:1000,
            isRuning:false,
            upMax:100,   // 速度上限
        }
        // 绑定点击开始抽奖事件
        function btnClickAction() {
            rollup()
        }
        // 绑定点击事件
        btnLottery.addEventListener("click", btnClickAction)
        // 当点击抽奖的时候 开启一个定时器运动 把当前的class去掉 下一个添加新的class
        function rollup() {
            inner[_index()].className  = "inner "
            ++defaultConfig.index
            btnLottery.removeEventListener("click",btnClickAction) //  // 禁用抽奖 防止重复进行点击
            inner[_index()].className  = "inner active"
            time = setTimeout(() => {
                rollup()
            }, defaultConfig.speed)
            if(!defaultConfig.isRuning){
                _up()
                defaultConfig.isRuning = true
            }
        }
        // 进行加速运动
       function _up(){
            if(defaultConfig.speed<=defaultConfig.upMax){
                _constant()
            }else{
                defaultConfig.speed-=100
                time1 = setTimeout(()=>{
                    _up()
                },defaultConfig.speed)

            }
        }
        // 有3秒时间进行匀速运动
        function _constant(){
            clearTimeout(time1)
            time2 = setTimeout(()=>{_down()},3000)
        }
        // 停止活动了 进行运动停止
        function _stop(){
            clearTimeout(time)
            clearTimeout(time4)
            btnLottery.addEventListener("click",btnClickAction)
            defaultConfig.isRuning = false
        }
        // 判断在某个条件下是否该进行停止跑马灯效果运动
        function _down(){
            if(defaultConfig.speed>1000&&_index() === 7){
                _stop()
            }else{
                clearTimeout(time2)
                defaultConfig.speed+=100
                time4 = setTimeout(()=>{_down()},defaultConfig.speed)
            }
            console.log(defaultConfig.speed,_index(),defaultConfig.index)
        }
        // 获取_index 进行取余来代替index 余数肯定不会大于他的最大个数
        function _index() {
            return defaultConfig.index%9
        }
        // 进行抽奖加速


    }

</script>
</body>
</html>
